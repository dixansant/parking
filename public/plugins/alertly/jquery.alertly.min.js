jQuery && function (e) {
   e.alertly = function(j) {
           var o = {
               title : '',
               content : '',
               btns : '',
           };
           o = $.extend({},j);
           o.btns = function(k){
               var r='';
                for(t in k){
                    var ty= k[t].type || 'default';
                    r+='<a class="btn-alertly btn btn-'+ty+'">'+(k[t].caption || 'Cancel' )+'</a>'
                }
                return r;
           }(j.buttons)

            o.title=(o.title)?'<b>'+o.title+'</b>':'';
           var u='<div class="alertly-bg">\n' +
           '        <div class="alertly-modal out">\n' +
                        o.title +
           '            <div class="alertly-body">\n' +
           '                <div class="alertly-msg">\n' +
                            o.content +
           '                </div>\n' +
           '                <div class="alertly-btns">\n' +
                            o.btns +
           '                </div>\n' +
           '            </div>\n' +
           '        </div>\n' +
           '    </div>'

            $(document.body).prepend(u)
            $('.alertly-bg').show();
            $('.alertly-modal').removeClass('out')
            $('.btn-alertly').click(function(){
                nm=$(this).html();
                b = o.buttons
                for (t in b) if (b[t].caption==nm) if (b[t].handle) b[t].handle();
                hideAlert()
            })
   };
}(jQuery);

function hideAlert(){
    $('.alertly-modal').addClass('in')
    $('.alertly-bg').fadeTo('fast',0,function(){
        $('.alertly-bg').remove();
    });
}

document.onkeydown = function(e) {
    e = e || window.event;
    _e = false;
    if ("key" in e)_e = (e.key == "Escape" || e.key == "Esc");
    else _e = (e.keyCode == 27);
    if (_e) hideAlert()

};


